(self.webpackChunkclient=self.webpackChunkclient||[]).push([[549],{6024:function(e,r,n){"use strict";n.d(r,{Z:function(){return k}});var t,a,i=n(2791),o=n(4395),c=n(1614),s=n(4663),l=n(1123),d=n(68),u=n(3400),m=n(9875),p=n(8977),h=n(1413),f=["title","titleId"];function v(){return v=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},v.apply(this,arguments)}function g(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n,t,a={},i=Object.keys(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)n=i[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function x(e,r){var n=e.title,o=e.titleId,c=g(e,f);return i.createElement("svg",v({width:97,height:18,viewBox:"0 0 97 18",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:r,"aria-labelledby":o},c),n?i.createElement("title",{id:o},n):null,t||(t=i.createElement("path",{d:"M0.161594 0.92H11.1776V3.704H3.35359V7.16H10.6016V9.92H3.35359V17H0.161594V0.92ZM17.1647 11.624C16.3647 11.624 15.7407 11.776 15.2927 12.08C14.8607 12.384 14.6447 12.8 14.6447 13.328C14.6447 13.824 14.8207 14.208 15.1727 14.48C15.5247 14.752 15.9567 14.888 16.4687 14.888C17.4767 14.888 18.2687 14.568 18.8447 13.928V11.888C18.4287 11.712 17.8687 11.624 17.1647 11.624ZM13.1807 8.384H12.9407V5.648C13.2607 5.44 13.8047 5.24 14.5727 5.048C15.3567 4.856 16.1327 4.76 16.9007 4.76C18.4527 4.76 19.6847 5.136 20.5967 5.888C21.5247 6.64 21.9887 7.696 21.9887 9.056V17H19.0127V16.088C18.7087 16.424 18.2607 16.72 17.6687 16.976C17.0767 17.216 16.4207 17.336 15.7007 17.336C14.5647 17.336 13.5887 17 12.7727 16.328C11.9727 15.64 11.5727 14.68 11.5727 13.448C11.5727 12.232 12.0687 11.256 13.0607 10.52C14.0527 9.784 15.2847 9.416 16.7567 9.416C17.5407 9.416 18.2367 9.536 18.8447 9.776V9.32C18.8447 8.04 18.0287 7.4 16.3967 7.4C15.7247 7.4 15.0927 7.496 14.5007 7.688C13.9247 7.88 13.4847 8.112 13.1807 8.384ZM31.8699 8.288H31.6299C31.3259 8.048 30.9019 7.84 30.3579 7.664C29.8139 7.472 29.2539 7.376 28.6779 7.376C27.6219 7.376 27.0939 7.68 27.0939 8.288C27.0939 8.496 27.1899 8.688 27.3819 8.864C27.5899 9.04 27.7659 9.16 27.9099 9.224C28.0699 9.288 28.3339 9.384 28.7019 9.512L30.1899 10.088C31.0379 10.424 31.6939 10.856 32.1579 11.384C32.6219 11.912 32.8539 12.672 32.8539 13.664C32.8539 14.736 32.4139 15.616 31.5339 16.304C30.6539 16.992 29.5019 17.336 28.0779 17.336C26.5419 17.336 25.2619 17.032 24.2379 16.424V13.664H24.4779C24.8459 13.952 25.3579 14.208 26.0139 14.432C26.6859 14.64 27.2939 14.744 27.8379 14.744C29.2139 14.744 29.9019 14.368 29.9019 13.616C29.9019 13.296 29.7899 13.04 29.5659 12.848C29.3419 12.64 28.9499 12.432 28.3899 12.224L26.9979 11.696C25.1099 10.976 24.1659 9.808 24.1659 8.192C24.1659 7.248 24.5659 6.44 25.3659 5.768C26.1819 5.096 27.2219 4.76 28.4859 4.76C29.8299 4.76 30.9579 5.056 31.8699 5.648V8.288ZM42.2578 7.592H39.3298V13.328C39.3298 13.856 39.4498 14.2 39.6898 14.36C39.9138 14.52 40.3298 14.6 40.9378 14.6C41.4018 14.6 41.7778 14.56 42.0658 14.48V17.096C41.5538 17.192 40.8338 17.24 39.9058 17.24C38.5138 17.24 37.5378 16.96 36.9778 16.4C36.6418 16.064 36.4258 15.688 36.3298 15.272C36.2338 14.856 36.1858 14.264 36.1858 13.496V7.592H33.6418V5.096H36.1858V1.976H39.3298V5.096H42.2578V7.592Z",fill:"black"})),a||(a=i.createElement("path",{d:"M55.859 8.312L53.699 13.112H51.155C50.067 10.728 49.347 9.128 48.995 8.312C48.803 7.896 48.547 7.32 48.227 6.584C47.923 5.832 47.683 5.248 47.507 4.832H47.483C47.483 5.12 47.499 5.664 47.531 6.464C47.563 7.248 47.579 7.872 47.579 8.336V17H44.435V0.92H48.659L51.371 6.968C51.547 7.384 51.739 7.872 51.947 8.432C52.171 8.976 52.323 9.36 52.403 9.584H52.427C52.875 8.4 53.235 7.512 53.507 6.92L56.219 0.92H60.347V17H57.203V8.288C57.203 7.824 57.219 7.208 57.251 6.44C57.283 5.672 57.299 5.136 57.299 4.832H57.275C57.195 5.024 56.987 5.536 56.651 6.368C56.331 7.184 56.067 7.832 55.859 8.312ZM73.2069 16.208C72.1829 16.96 70.7189 17.336 68.8149 17.336C66.9109 17.336 65.3829 16.768 64.2309 15.632C63.0949 14.48 62.5269 12.984 62.5269 11.144C62.5269 9.32 63.0869 7.8 64.2069 6.584C65.3269 5.368 66.7429 4.76 68.4549 4.76C70.1829 4.76 71.5429 5.36 72.5349 6.56C73.5429 7.76 74.0469 9.36 74.0469 11.36C74.0469 11.44 74.0389 11.552 74.0229 11.696C74.0229 11.84 74.0229 11.936 74.0229 11.984C74.0069 12.048 73.9989 12.144 73.9989 12.272H65.5749C65.8789 13.888 67.0469 14.696 69.0789 14.696C70.6629 14.696 71.9589 14.296 72.9669 13.496H73.2069V16.208ZM65.5509 9.944H71.0469C71.0149 9.128 70.7669 8.48 70.3029 8C69.8389 7.52 69.2229 7.28 68.4549 7.28C67.7029 7.28 67.0469 7.52 66.4869 8C65.9429 8.464 65.6309 9.112 65.5509 9.944ZM85.91 16.208C84.886 16.96 83.422 17.336 81.518 17.336C79.614 17.336 78.086 16.768 76.934 15.632C75.798 14.48 75.23 12.984 75.23 11.144C75.23 9.32 75.79 7.8 76.91 6.584C78.03 5.368 79.446 4.76 81.158 4.76C82.886 4.76 84.246 5.36 85.238 6.56C86.246 7.76 86.75 9.36 86.75 11.36C86.75 11.44 86.742 11.552 86.726 11.696C86.726 11.84 86.726 11.936 86.726 11.984C86.71 12.048 86.702 12.144 86.702 12.272H78.278C78.582 13.888 79.75 14.696 81.782 14.696C83.366 14.696 84.662 14.296 85.67 13.496H85.91V16.208ZM78.254 9.944H83.75C83.718 9.128 83.47 8.48 83.006 8C82.542 7.52 81.926 7.28 81.158 7.28C80.406 7.28 79.75 7.52 79.19 8C78.646 8.464 78.334 9.112 78.254 9.944ZM96.1172 7.592H93.1892V13.328C93.1892 13.856 93.3092 14.2 93.5492 14.36C93.7732 14.52 94.1892 14.6 94.7972 14.6C95.2612 14.6 95.6372 14.56 95.9252 14.48V17.096C95.4132 17.192 94.6932 17.24 93.7652 17.24C92.3732 17.24 91.3972 16.96 90.8372 16.4C90.5012 16.064 90.2852 15.688 90.1892 15.272C90.0932 14.856 90.0452 14.264 90.0452 13.496V7.592H87.5012V5.096H90.0452V1.976H93.1892V5.096H96.1172V7.592Z",fill:"#8C8C8C"})))}var j=i.forwardRef(x),b=(n.p,n(184));var C=function(e){var r=Object.assign({},e);return(0,b.jsx)(j,(0,h.Z)({},r))},Z=n(3504),y=n(416);var k=function(){return(0,b.jsx)(o.Z,{color:"transparent",elevation:0,children:(0,b.jsx)(c.Z,{maxWidth:"xl",children:(0,b.jsxs)(s.Z,{disableGutters:!0,children:[(0,b.jsx)(Z.rU,{to:y.g.HOME,children:(0,b.jsx)(C,{})}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsx)(l.Z,{children:(0,p.Z)(new Date,"p . E, LLL qo")}),(0,b.jsx)("div",{className:"flex items-center",children:(0,b.jsx)(d.Z,{title:"Settings",children:(0,b.jsx)(u.Z,{children:(0,b.jsx)(m.Z,{children:"settings"})})})})]})})})}},6183:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return Ze}});var t=n(2982),a=n(885),i=n(9875),o=n(1614),c=n(2791),s=n(5705),l=n(1724),d=n(6871),u=n(9105),m=n(2711),p=n(6024),h=n(1413),f=n(5987),v=n(184),g=["srcObject","muted","peer"];function x(e){var r=e.srcObject,n=e.muted,t=e.peer,a=(0,f.Z)(e,g),i=(0,c.useRef)(null);return(0,c.useEffect)((function(){if(r){if(!i.current)return;i.current.srcObject=r,i.current.autoplay=!0}}),[r]),(0,c.useEffect)((function(){t&&t.on("stream",(function(e){i.current&&(i.current.srcObject=e,i.current.autoplay=!0)}))}),[t]),(0,v.jsx)("video",(0,h.Z)({playsInline:!0,muted:n,autoPlay:!0,ref:i,width:"100%",height:"100%"},a))}var j=["pin","name","camera","active","mic","srcObject","peer","avatar","muted","header","footer","body","className"];function b(e){e.pin;var r=e.name,n=e.camera,t=e.active,a=(e.mic,e.srcObject),i=e.peer,o=e.avatar,c=e.muted,s=e.header,l=e.footer,d=e.body,u=e.className,m=(0,f.Z)(e,j);return(0,v.jsxs)("div",(0,h.Z)((0,h.Z)({},m),{},{className:"".concat(u||""," ").concat(t?"vids-preview-active":""," vids-preview-container relative "),children:[(0,v.jsx)("div",{className:"absolute top-0 py-3 px-5  w-full",children:s}),(0,v.jsx)("div",{className:"absolute top-0 bottom-0 px-5  left-0 right-0 m-auto py-5 flex justify-center items-center w-full",children:d}),(0,v.jsxs)("div",{className:"flex justify-center items-center h-full",children:[(0,v.jsx)(x,{style:{display:"".concat(n?"block":"none")},srcObject:a,peer:i,muted:c}),!n&&r&&(0,v.jsx)("div",{className:"vids-preview-avatar",children:(0,v.jsx)("img",{className:"w-full",src:"".concat(o||""),alt:r})})]}),(0,v.jsx)("div",{className:"absolute bottom-0 py-3 px-5  w-full",children:l})]}))}var C=n(9342),Z=n.n(C),y=n(7532),k=n.n(y);var w=n(1123);function S(e){var r=e.streamError;return(0,v.jsx)(v.Fragment,{children:!!r&&(0,v.jsxs)("div",{className:"flex items-center flex-col",children:[(0,v.jsx)(i.Z,{color:"error",sx:{fontSize:"100px"},children:(0,v.jsx)(m.JO,{icon:"fluent:error-circle-16-regular"})}),(0,v.jsx)(w.Z,{variant:"h5",color:"error",children:r})]})})}var O=n(8610),_=n(3719),N=n(2003),M=n(703),R=n(9877),V=n(9891),H=n(5289),T=n(5661),I=n(9157),A=n(8517),W=n(7123),E=n(6151);function z(e){var r=e.open,n=e.handleClose,i=(e.localMediaStream,(0,c.useState)([])),o=(0,a.Z)(i,2),s=o[0],l=o[1],d=(0,c.useState)([]),u=(0,a.Z)(d,2),m=u[0],p=u[1],h=(0,c.useState)([]),f=(0,a.Z)(h,2),g=f[0],x=f[1],j=function(e,r){var n=(0,t.Z)(e),a=n.findIndex((function(e){return e.id===r.deviceId}));return a>=0?n[a]={label:r.label,kind:r.kind,id:r.deviceId}:n.push({label:r.label,kind:r.kind,id:r.deviceId}),n};function b(e){e.forEach((function(e){switch(e.kind){case"audioinput":l((function(r){return j(r,e)}));break;case"audiooutput":p((function(r){return j(r,e)}));break;case"videoinput":x((function(r){return j(r,e)}));break;default:console.log("Some other kind of source/device: ",e)}}))}return(0,c.useEffect)((function(){var e,r;null===(e=navigator)||void 0===e||null===(r=e.mediaDevices)||void 0===r||r.enumerateDevices().then(b).catch((function(e){return console.log("navigator.MediaDevices.getUserMedia error: ",e.message,e.name)}))}),[]),(0,v.jsxs)(H.Z,{open:r,onClose:n,"aria-labelledby":"video-meet-settings-action-modal","aria-describedby":"video-meet-settings-action-modal",maxWidth:"sm",fullWidth:!0,children:[(0,v.jsx)(T.Z,{children:"Settings"}),(0,v.jsxs)(I.Z,{children:[(0,v.jsx)(A.Z,{label:"Audio Input",className:"mb-3 mt-2",fullWidth:!0,select:!0,children:s.map((function(e,r){return(0,v.jsx)(V.Z,{value:e.id,children:e.label},r)}))}),(0,v.jsx)(A.Z,{label:"Audio Output",className:"mb-3",fullWidth:!0,select:!0,children:m.map((function(e,r){return(0,v.jsx)(V.Z,{value:e.id,children:e.label},r)}))}),(0,v.jsx)(A.Z,{label:"Video Cam",className:"mb-3",fullWidth:!0,select:!0,children:g.map((function(e,r){return(0,v.jsx)(V.Z,{value:e.id,children:e.label},r)}))})]}),(0,v.jsx)(W.Z,{children:(0,v.jsx)(E.Z,{onClick:n,children:"Cancel"})})]})}function P(e){var r=e.localMediaStream,n=(0,c.useState)(!1),t=(0,a.Z)(n,2),o=t[0],s=t[1],l=[{title:"Settings",action:function(){return s(!0)}},{title:"Filter",action:function(){return console.log("testi")}}];return(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("div",{className:"flex justify-end",children:(0,v.jsx)("div",{children:(0,v.jsx)(_.ZP,{variant:"popper",popupId:"demo-popup-popper",children:function(e){return(0,v.jsxs)("div",{children:[(0,v.jsx)(R.Z,(0,h.Z)((0,h.Z)({variant:"opaque",color:"primary"},(0,_.LI)(e)),{},{children:(0,v.jsx)(i.Z,{children:(0,v.jsx)(m.JO,{icon:"bi:three-dots-vertical"})})})),(0,v.jsx)(O.Z,(0,h.Z)((0,h.Z)({},(0,_.Rg)(e)),{},{sx:{zIndex:100},transition:!0,children:function(e){var r=e.TransitionProps;return(0,v.jsx)(N.Z,(0,h.Z)((0,h.Z)({},r),{},{timeout:350,children:(0,v.jsx)(M.Z,{children:l.map((function(e,r){return(0,v.jsx)(V.Z,{onClick:e.action,children:e.title},r)}))})}))}}))]})}})})}),o&&(0,v.jsx)(z,{open:o,handleClose:function(){return s(!1)},localMediaStream:r})]})}function D(e){var r=e.toggleCamera,n=e.toggleAudio,t=e.mic,a=e.camera;return(0,v.jsxs)("div",{className:"flex justify-center gap-2",children:[(0,v.jsx)(R.Z,{variant:"opaque",color:"".concat(t?"primary":"error"),onClick:n,children:(0,v.jsx)(i.Z,{children:(0,v.jsx)(m.JO,{icon:"".concat(t?"carbon:microphone":"carbon:microphone-off")})})}),(0,v.jsx)(R.Z,{variant:"opaque",color:"".concat(a?"primary":"error"),onClick:r,children:(0,v.jsx)(i.Z,{children:(0,v.jsx)(m.JO,{icon:"".concat(a?"bi:camera-video":"bi:camera-video-off")})})})]})}var F=n(6934),J=n(4834),L=n(68),q=n(8977),U=n(4318),Q=(0,F.ZP)(J.ZP)((function(e){e.theme;return{"& .MuiInputBase-input":{position:"relative",backgroundColor:"transparent",border:"none",width:"auto",padding:".2rem .5rem",color:"white",fontSize:"0.75rem"}}}));function B(e){var r=e.toggleCamera,n=e.toggleAudio,t=e.raiseHand,a=e.hangUp,o=e.toggleScreenSharing,s=e.mic,l=e.camera,d=e.hand,u=e.toggleRecordStream,p=e.isScreenRecord,h=(e.screenShare,e.localMediaStream),f=e.peers,g=e.formik,x=e.getAvatarQuery,j=e.onInputName,C=(0,c.useMemo)((function(){return[{title:"".concat(s?"Off Mic":"On Mic"),variant:"opaque",color:"".concat(s?"primary":"error"),onClick:n,size:"small",icon:"".concat(s?"carbon:microphone":"carbon:microphone-off")},{title:"".concat(l?"Off Camera":"On Camera"),variant:"opaque",color:"".concat(l?"primary":"error"),onClick:r,size:"small",icon:"".concat(l?"bi:camera-video":"bi:camera-video-off")},{title:"".concat(d?"End Raise Hand":"Raise Hand"),variant:"opaque",color:"primary",onClick:t,size:"small",icon:"emojione-monotone:hand-with-fingers-splayed"},{title:"Share Screen",variant:"opaque",color:"primary",onClick:o,size:"small",icon:"fluent:share-screen-start-24-regular"},{title:"".concat(p?"End Record":"Record"),variant:"opaque",color:"".concat(p?"error":"primary"),onClick:u,size:"small",icon:"mdi:record-circle-outline"},{title:"End Call",variant:"opaque",color:"error",onClick:a,size:"small",icon:"simple-line-icons:call-end"}]}),[l,s,p,d]),Z=function(e){j(e,(function(e){g.setFieldValue("name",e)}))};return(0,v.jsxs)("div",{className:"bg-[#000000] overflow-y-hidden h-screen max-h-screen min-h-[500px]",children:[(0,v.jsx)("main",{className:"overflow-y-scroll",children:(0,v.jsx)("div",{className:"h-[calc(100vh-80px)] pt-5 px-3",children:f.length>=1?(0,v.jsxs)("div",{className:"layout-grid-auto h-full",children:[(0,v.jsx)(b,{camera:l,mic:s,muted:!0,active:!0,name:g.values.name,avatar:x.data.data,srcObject:h,header:(0,v.jsx)("div",{children:(0,v.jsx)(i.Z,{style:{color:"".concat(U.Z.palette.common.white)},children:(0,v.jsx)(m.JO,{icon:"".concat(s?"clarity:microphone-solid":"clarity:microphone-mute-solid")})})}),footer:(0,v.jsxs)("div",{className:"flex gap-2",children:[d&&(0,v.jsx)(L.Z,{title:"Hand Raised",placement:"top",children:(0,v.jsx)(i.Z,{className:"wave-hand",children:(0,v.jsx)(m.JO,{icon:"emojione:waving-hand-medium-dark-skin-tone"})})}),(0,v.jsx)(Q,{value:g.values.name||"",onChange:Z})]})}),null===f||void 0===f?void 0:f.map((function(e,r){return(0,v.jsx)(b,{camera:e.userObj.peer_video,mic:e.userObj.peer_audio,muted:!0,active:!1,avatar:e.userObj.avatar,peer:e.peerObj,name:e.userObj.peer_name,header:(0,v.jsx)("div",{children:(0,v.jsx)(i.Z,{style:{color:"".concat(U.Z.palette.common.white)},children:(0,v.jsx)(m.JO,{icon:"".concat(e.userObj.peer_audio?"clarity:microphone-solid":"clarity:microphone-mute-solid")})})}),footer:(0,v.jsxs)("div",{className:"flex gap-2",children:[e.userObj.peer_raised_hand&&(0,v.jsx)(L.Z,{title:"Hand Raised",placement:"top",children:(0,v.jsx)(i.Z,{className:"wave-hand",children:(0,v.jsx)(m.JO,{icon:"emojione:waving-hand-medium-dark-skin-tone"})})}),(0,v.jsx)(w.Z,{className:"vids-preview-title",color:"white",variant:"subtitle2",children:e.userObj.peer_name})]})},r)}))]}):(0,v.jsx)(b,{className:"h-[calc(100vh-100px)]",camera:l,mic:s,muted:!0,active:!0,name:g.values.name,avatar:x.data.data,srcObject:h,header:(0,v.jsx)("div",{children:(0,v.jsx)(i.Z,{style:{color:"".concat(U.Z.palette.common.white)},children:(0,v.jsx)(m.JO,{icon:"".concat(s?"clarity:microphone-solid":"clarity:microphone-mute-solid")})})}),footer:(0,v.jsxs)("div",{className:"flex gap-2",children:[d&&(0,v.jsx)(L.Z,{title:"Hand Raised",placement:"top",children:(0,v.jsx)(i.Z,{className:"wave-hand",children:(0,v.jsx)(m.JO,{icon:"emojione:waving-hand-medium-dark-skin-tone"})})}),(0,v.jsx)(Q,{value:g.values.name||"",onChange:Z})]})})})}),(0,v.jsxs)("footer",{className:"flex justify-between gap-2 items-center my-3 mx-3",children:[(0,v.jsx)("div",{className:"flex item-center",children:(0,v.jsxs)(w.Z,{color:"white",variant:"subtitle1",fontWeight:500,children:[(0,q.Z)(new Date,"p")," | Fast Meet"]})}),(0,v.jsx)("div",{className:"flex gap-2",children:C.map((function(e,r){return(0,v.jsx)(L.Z,{title:e.title,children:(0,v.jsx)(R.Z,{variant:e.variant,color:e.color,onClick:e.onClick,size:e.size,children:(0,v.jsx)(i.Z,{children:(0,v.jsx)(m.JO,{icon:e.icon})})})},r)}))}),(0,v.jsx)("div",{})]})]})}var G=function(e){var r=(0,c.useRef)(e);return r.current=e,r},K=n(8560),$=n(8182),X=["title","description","className","onTryAgain"];function Y(e){var r=e.title,n=e.description,t=e.className,a=(e.onTryAgain,(0,f.Z)(e,X));return(0,v.jsxs)("div",(0,h.Z)((0,h.Z)({className:(0,$.Z)("p-8 flex flex-col justify-center items-center",t)},a),{},{children:[(0,v.jsx)(w.Z,{variant:"h6",className:"font-bold text-center",children:r}),(0,v.jsx)("div",{children:(0,v.jsx)(i.Z,{className:"text-error-main",style:{fontSize:"100px"},children:"sentiment_dissatisfied"})}),(0,v.jsx)(w.Z,{variant:"body2",className:"text-center mb-4 font-bold",children:n})]}))}Y.defaultProps={title:"Something went wrong",description:"We're quite sorry about this!"};var ee=Y,re=["size","error","loading","children","onReload","onMount","loadingContent","errorContent","className"];function ne(e){var r=e.size,n=e.error,t=e.loading,a=e.children,i=e.onReload,o=e.onMount,s=e.loadingContent,l=e.errorContent,d=e.className,u=(0,f.Z)(e,re),m=G({onReload:i,onMount:o});if((0,c.useEffect)((function(){var e,r;null===(e=(r=m.current).onMount)||void 0===e||e.call(r)}),[m]),!t&&!n&&void 0!==a)return"function"===typeof a?a():a;var p=(0,v.jsx)(K.Z,{size:r}),g=(0,v.jsx)(ee,{onTryAgain:function(){return null===i||void 0===i?void 0:i()}});return(0,v.jsx)("div",(0,h.Z)((0,h.Z)({className:(0,$.Z)("flex flex-col justify-center items-center p-4",d)},u),{},{children:n?(0,v.jsx)(v.Fragment,{children:l?"function"===typeof l?l(g):l:g}):s?"function"===typeof s?s(p):s:p}))}ne.defaultProps={size:40,children:null};var te=ne,ae=n(765),ie=n(5523),oe=n(97);function ce(e){var r=e.formik;return(0,v.jsxs)("form",{onSubmit:r.handleSubmit,className:"flex flex-col  items-center w-full justify-around h-full",children:[(0,v.jsxs)("div",{className:"w-full",children:[(0,v.jsx)(A.Z,(0,h.Z)((0,h.Z)({label:"Name",placeholder:"Sylvernus Akubo",fullWidth:!0},r.getFieldProps("name")),{},{error:r.touched.name&&Boolean(r.errors.name),helperText:r.touched.name&&r.errors.name})),(0,v.jsxs)(ae.Z,(0,h.Z)((0,h.Z)({"aria-label":"gender",row:!0},r.getFieldProps("gender")),{},{className:"flex justify-center",children:[(0,v.jsx)(ie.Z,{value:"female",control:(0,v.jsx)(oe.Z,{}),label:"Female"}),(0,v.jsx)(ie.Z,{value:"male",control:(0,v.jsx)(oe.Z,{}),label:"Male"})]}))]}),(0,v.jsx)(E.Z,{size:"large",fullWidth:!0,type:"submit",className:"mt-10",children:"Join Meeting"})]})}function se(e){switch(e){case"male":return"His";case"female":return"Her"}}var le=n(4876);function de(e){var r=c.useState(new Audio("".concat(le._n,"/sounds/").concat(e,".mp3")));return(0,a.Z)(r,1)[0]}var ue=n(4165),me=n(5861),pe=n(5048),he=n(8100),fe=n(3667),ve=n.n(fe),ge=n(7367);function xe(e){var r=c.useState(e&&e),n=(0,a.Z)(r,2),t=n[0],i=n[1];return[t,i,function(){return new Promise((function(e,r){i((function(r){return e(r),r}))}))}]}var je=function(e,r){var n=r.canJoinMeeting,o=(0,pe.v9)((function(e){return e.global})),s=(0,u.Ds)().enqueueSnackbar,l=(0,pe.I0)(),d=(0,c.useState)([]),p=(0,a.Z)(d,2),h=p[0],f=p[1],g=(0,c.useState)(""),x=(0,a.Z)(g,2),j=x[0],b=x[1],C=xe(),Z=(0,a.Z)(C,2),y=Z[0],k=Z[1],w=xe(!1),S=(0,a.Z)(w,2),O=S[0],_=S[1],N=xe(!1),M=(0,a.Z)(N,3),R=M[0],V=M[1],H=M[2],T=xe(),I=(0,a.Z)(T,3),A=(I[0],I[1]),W=I[2],E=xe(!1),z=(0,a.Z)(E,3),P=z[0],D=z[1],F=z[2],J=xe([]),L=(0,a.Z)(J,3),q=(L[0],L[1]),Q=L[2],B=o.camera,G=o.mic,K=o.iceServers,$=de("raiseHand"),X=de("recStart"),Y=de("recStop"),ee=ge.Z.useGetTurnServerQuery({});function re(){return(re=(0,me.Z)((0,ue.Z)().mark((function r(t){return(0,ue.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:void 0!==y&&(y.getVideoTracks()[0].enabled=!y.getVideoTracks()[0].enabled,console.log("localMediaStream.getVideoTracks()[0].enabled",y.getVideoTracks()[0].enabled),l((0,he.JK)(!!y.getVideoTracks()[0].enabled)),n&&(le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"video",status:!!y.getVideoTracks()[0].enabled}),s((0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Z,{style:{color:"".concat(U.Z.palette.common.white)},children:(0,v.jsx)(m.JO,{icon:"".concat(B?"heroicons:video-camera-solid":"heroicons:video-camera-slash-solid")})})," ",B?"Camera turned on":"Camera turned off"]}),{anchorOrigin:{vertical:"top",horizontal:"right"}})),t&&t(!!y.getVideoTracks()[0].enabled));case 1:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function ne(){return(ne=(0,me.Z)((0,ue.Z)().mark((function r(t){return(0,ue.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:void 0!==y&&(y.getAudioTracks()[0].enabled=!y.getAudioTracks()[0].enabled,l((0,he.az)(!!y.getAudioTracks()[0].enabled)),n&&(le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"audio",status:!!y.getAudioTracks()[0].enabled}),s((0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(i.Z,{style:{color:"".concat(U.Z.palette.common.white)},children:(0,v.jsx)(m.JO,{icon:"".concat(G?"clarity:microphone-solid":"clarity:microphone-mute-solid")})}),G?"Microphone turned on":"Microphone turned off"]}),{anchorOrigin:{vertical:"top",horizontal:"right"}})),t&&t(!!y.getAudioTracks()[0].enabled));case 1:case"end":return r.stop()}}),r)})))).apply(this,arguments)}function te(){try{Q().then((function(e){if(void 0!==e){var r=e[0].type.includes("mp4")?"mp4":"webm",n=new Blob(e,{type:"video/"+r}),t=function(){var e=new Date,r=e.toISOString().split("T")[0],n=e.toTimeString().split(" ")[0];return"".concat(r,"-").concat(n)}()+"-REC."+r;console.log("Please wait to be processed, then will be downloaded to your ".concat("PC"," device")),function(e,r){var n=window.URL.createObjectURL(e),t=document.createElement("a");t.style.display="none",t.href=n,t.download=r,document.body.appendChild(t),t.click(),setTimeout((function(){document.body.removeChild(t),window.URL.revokeObjectURL(n)}),100)}(n,t)}}))}catch(e){console.log("error","Recording save failed: "+e)}}function ae(r){Y.play(),console.log("MediaRecorder stopped: ",r),D(!1),le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"rec",status:!1}),te()}function ie(e){console.log("MediaRecorder data: ",e),e.data&&e.data.size>0&&q((function(r){return[].concat((0,t.Z)(r),[e.data])}))}function oe(){W().then((function(e){console.log("mediaRecorder",e),X.play(),e.start(),e.addEventListener("dataavailable",ie),e.addEventListener("stop",ae)}))}function ce(){q([]);var r=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm;codecs=h264,opus","video/mp4;codecs=h264,aac","video/mp4"].filter((function(e){return MediaRecorder.isTypeSupported(e)}));console.log("MediaRecorder options supported",r);var n={mimeType:null===r||void 0===r?void 0:r[0]};try{navigator.mediaDevices.getDisplayMedia({video:!0}).then((function(r){var t=new MediaStream([r.getVideoTracks()[0],y.getAudioTracks()[0]]);A(new MediaRecorder(t,n)),D(!0),oe(),le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"rec",status:!0})})).catch((function(e){console.error("[Error] Unable to recording the screen + audio",e)}))}catch(t){console.error("Exception while creating MediaRecorder: ",t)}}function se(e){return fe.apply(this,arguments)}function fe(){return fe=(0,me.Z)((0,ue.Z)().mark((function e(r){var n,t,a=arguments;return(0,ue.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],void 0!==y){e.next=3;break}return e.abrupt("return");case 3:R&&(r.getVideoTracks()[0].enabled=!0),t=null,R?(console.log("Refresh my local media stream AUDIO"),t=new MediaStream([n?r.getAudioTracks()[0]:y.getAudioTracks()[0]])):(console.log("Refresh my local media stream VIDEO - AUDIO"),t=new MediaStream([r.getVideoTracks()[0],n?r.getAudioTracks()[0]:y.getAudioTracks()[0]])),k(t),H().then((function(e){e||(r.getVideoTracks()[0].onended=function(){be()},y.getVideoTracks()[0].enabled=!1)}));case 8:case"end":return e.stop()}}),e)}))),fe.apply(this,arguments)}function je(e,r){r.replaceTrack(r.streams[0].getVideoTracks()[0],e.getVideoTracks()[0],r.streams[0])}function be(){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,me.Z)((0,ue.Z)().mark((function r(){return(0,ue.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:H().then(function(){var r=(0,me.Z)((0,ue.Z)().mark((function r(n){var a,i;return(0,ue.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a={audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:44100,cursor:"always"},video:!0},r.prev=1,!1!==n){r.next=9;break}return console.log("on screen sharing start"),r.next=6,navigator.mediaDevices.getDisplayMedia(a);case 6:i=r.sent,r.next=13;break;case 9:return console.log("on screen sharing stop"),r.next=12,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 12:i=r.sent;case 13:if(!i){r.next=19;break}return console.log("call refresh localstream"),r.next=17,se(i);case 17:f((function(e){var r=(0,t.Z)(e);return r.forEach((function(e){return je(i,e.peerObj)})),r})),le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"screen",status:!n});case 19:V(!n),r.next=25;break;case 22:r.prev=22,r.t0=r.catch(1),console.error("[Error] Unable to share the screen",r.t0);case 25:case"end":return r.stop()}}),r,null,[[1,22]])})));return function(e){return r.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)}))),Ce.apply(this,arguments)}function Ze(){return Ze=(0,me.Z)((0,ue.Z)().mark((function r(){return(0,ue.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n&&_((function(r){return console.log("handRaisedref",r),s("".concat(r?"Hand Raised \u270b":"Hand Down \u270b"),{anchorOrigin:{vertical:"top",horizontal:"right"}}),r&&$.play(),le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"hand",status:!r}),!r}));case 1:case"end":return r.stop()}}),r)}))),Ze.apply(this,arguments)}return(0,c.useEffect)((function(){K&&(0,le.Gd)(b,(function(e){k(e),l((0,he.JK)(!0)),l((0,he.az)(!0))}),(function(){l((0,he.JK)(!1)),l((0,he.az)(!1))}))}),[K]),{camera:B,mic:G,handRaised:O,screenShare:R,localMediaStream:y,peers:h,streamError:j,toggleMic:function(e){return ne.apply(this,arguments)},toggleCamera:function(e){return re.apply(this,arguments)},hangUp:function(){n&&(void 0!==y&&(y.getVideoTracks()[0].enabled=!y.getVideoTracks()[0].enabled),le.Wb.disconnect(),"undefined"!==typeof window&&(window.location.href="/"))},raiseHand:function(){return Ze.apply(this,arguments)},onInputChangeName:function(r,n){var t=ve()(r.target.value);le.Wb.emit("peerActionStatus",{room_id:e,socket_id:le.Wb.id,element:"name",status:"".concat(t)}),n&&n(t)},addPeer:function(e){l((0,he.dq)(e))},editPeer:function(e){l((0,he.qU)(e))},isScreenRecord:P,deletePeer:function(e){l((0,he.kH)(e))},setPeers:f,iceServers:K,setStreamError:b,getTurnServerQuery:ee,toggleRecordStream:function(){F().then((function(e){e?W().then((function(e){e.stop()})):ce()}))},toggleScreenSharing:be}},be=n(4164);function Ce(){return(0,v.jsx)("section",{children:(0,be.createPortal)((0,v.jsxs)("section",{children:[" ",(0,v.jsxs)("div",{className:"recording__container",children:[(0,v.jsx)("div",{className:"recording__circle"}),(0,v.jsx)("div",{className:"recording__text",children:"Recording"})]})]}),document.body)})}function Ze(){var e=(0,d.UO)().meetId,r=(0,u.Ds)().enqueueSnackbar,n=(0,c.useRef)([]),h=(0,c.useRef)(!1),f=(0,c.useState)(!1),g=(0,a.Z)(f,2),x=g[0],j=g[1],C=de("addPeer"),y=de("raiseHand"),w=de("onlyParticipant"),O=de("newMessage"),_=de("recStart"),N=de("recStop"),M=je(e,{canJoinMeeting:x}),R=M.localMediaStream,V=M.handRaised,H=M.streamError,T=M.mic,I=M.peers,A=M.setPeers,W=M.camera,E=M.screenShare,z=M.toggleCamera,F=M.toggleRecordStream,J=M.isScreenRecord,L=M.toggleMic,q=M.hangUp,U=M.raiseHand,Q=M.iceServers,G=M.setStreamError,K=M.onInputChangeName,$=M.getTurnServerQuery,X=M.toggleScreenSharing,Y=(0,s.TA)({initialValues:{name:"",gender:"male",meetId:e},enableReinitialize:!0,validationSchema:l.Ry({name:l.Z_().label("Full Name").required("Required"),gender:l.Z_().label("Full Name").required("Required")}),onSubmit:function(e){j(!0)}}),ee=ge.Z.useGetAvatarQuery({category:Y.values.gender}),re=ee.data;function ne(a){0===I.length&&le.Wb.emit("join",e,{userAgent:navigator.userAgent.toLowerCase(),channel_password:"",avatar:null===re||void 0===re?void 0:re.data,peer_info:{detectRTCversion:Z().version,isWebRTCSupported:Z().isWebRTCSupported,isMobileDevice:Z().isMobileDevice,osName:Z().osName,osVersion:Z().osVersion,browserName:Z().browser.name,browserVersion:Z().browser.version},peer_name:Y.values.name,peer_gender:Y.values.gender,peer_video:W,peer_audio:T,peer_raised_hand:V,peer_screen_record:h.current,peer_screen_share:E}),le.Wb.on("clients-in-room",(function(e){var r=[];e.forEach((function(e){if(void 0!==Q){var n=function(e,r,n,t,a){var i=new(k())({initiator:!0,trickle:!1,stream:n,config:{iceServers:t}});return console.log("peer",i),i.on("signal",(function(n){a.emit("initiate-signal",{userToSignal:e,callerId:r,signal:n})})),i}(e.socketId,le.Wb.id,a,Q,le.Wb);C.play(),r.push({peerId:e.socketId,peerObj:n,userObj:e})}})),r.length>=1?(w.pause(),w.currentTime=0,w.loop=!1):(w.play(),w.loop=!0),n.current=r,A(r)})),le.Wb.on("user-joined",(function(e){if(void 0!==Q){var i,o,c=function(e,r,n,t,a){var i=new(k())({initiator:!1,trickle:!1,stream:n,config:{iceServers:t}});return i.on("signal",(function(e){a.emit("acknowledge-signal",{signal:e,callerId:r})})),i.signal(e),i}(e.signal,e.callerId,a,Q,le.Wb);n.current.push({peerId:e.callerId,peerObj:c,userObj:e.user}),A((function(r){var n=(0,t.Z)(r),a=n.findIndex((function(r){return r.peerId===e.callerId}));return void 0!==a?(n[a]={peerId:e.callerId,peerObj:c,userObj:e.user},n):[].concat((0,t.Z)(n),[{peerId:e.callerId,peerObj:c,userObj:e.user}])})),n.current.length>=1&&(w.pause(),w.currentTime=0,w.loop=!1),C.play(),r((0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)("img",{src:e.user.avatar,alt:null===(i=e.user)||void 0===i?void 0:i.peer_name,className:"w-full max-w-[50px] capitalize"})," ",null===(o=e.user)||void 0===o?void 0:o.peer_name," joined meeting"]}),{anchorOrigin:{vertical:"top",horizontal:"center"}})}})),le.Wb.on("signal-accepted",(function(e){n.current.find((function(r){return r.peerId===e.id})).peerObj.signal(e.signal)})),le.Wb.on("userDisconnected",(function(e){var t=n.current.find((function(r){return r.peerId===e.socketId}));t&&t.peerObj.destroy();var a=n.current.filter((function(r){return r.peerId!==e.socketId}));a.length>=1?(w.pause(),w.currentTime=0,w.loop=!1):(w.play(),w.loop=!0),r("".concat(t.userObj.peer_name," Left meeting"),{anchorOrigin:{vertical:"bottom",horizontal:"left"}}),n.current=a,A(a)})),le.Wb.on("peerActionStatus",(function(e){console.log("peerActionStatus",e),A((function(a){var o=a.findIndex((function(r){return r.peerId===e.socket_id})),c=(0,t.Z)(a),s=c[o];if(s)switch(e.element){case"video":s.userObj.peer_video=e.status;break;case"audio":s.userObj.peer_audio=e.status;break;case"screen":s.userObj.peer_screen_share=e.status,O.play(),r((0,v.jsxs)(v.Fragment,{children:[s.userObj.peer_name," `$",e.status?"Started":"Stopped","`Sharing Screen"]}),{anchorOrigin:{vertical:"top",horizontal:"right"}});break;case"hand":s.userObj.peer_raised_hand=e.status,s.userObj.peer_raised_hand&&(y.play(),r((0,v.jsxs)(v.Fragment,{children:[s.userObj.peer_name," Raised"," ",se(s.userObj.peer_gender)," Hand"," ",(0,v.jsx)(i.Z,{className:"wave-hand",children:(0,v.jsx)(m.JO,{icon:"emojione:waving-hand-medium-dark-skin-tone"})})]}),{anchorOrigin:{vertical:"top",horizontal:"right"}}));break;case"rec":s.userObj.peer_screen_record=e.status,s.userObj.peer_screen_record?(_.play(),r((0,v.jsxs)(v.Fragment,{children:[s.userObj.peer_name," started \ud83d\udd34 REC"]}),{anchorOrigin:{vertical:"top",horizontal:"right"}})):(N.play(),r((0,v.jsxs)(v.Fragment,{children:[s.userObj.peer_name," stopped \ud83d\udd34 REC"]}),{anchorOrigin:{vertical:"top",horizontal:"right"}}));break;case"name":s.userObj.peer_name=e.status}return n.current=c,console.log("newPeer",c),c}))}))}return(0,c.useEffect)((function(){x&&void 0!==R&&void 0!==Q&&ne(R)}),[x]),(0,c.useEffect)((function(){return function(){w.pause()}}),[]),x?(0,v.jsx)(v.Fragment,{children:(0,v.jsx)(te,{loading:$.isLoading||ee.isLoading,error:!!$.error||!!ee.error,children:(0,v.jsxs)(v.Fragment,{children:[J?(0,v.jsx)(Ce,{}):null,(0,v.jsx)(B,{camera:W,mic:T,toggleCamera:z,raiseHand:U,hangUp:q,formik:Y,peers:I,isScreenRecord:J,localMediaStream:R,getAvatarQuery:ee,screenShare:E,toggleRecordStream:F,toggleScreenSharing:X,hand:V,toggleAudio:L,onInputName:K})]})})}):(0,v.jsxs)("div",{className:"bg-gray-100  min-h-screen",children:[(0,v.jsx)(p.Z,{}),(0,v.jsx)(te,{loading:$.isLoading,error:!!$.error,children:(0,v.jsx)(o.Z,{maxWidth:"xl",className:"flex min-h-screen items-center",children:(0,v.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-10 w-full",children:[(0,v.jsx)(ce,{formik:Y}),(0,v.jsx)("div",{className:"col-span-2 -order-1 md:order-1 h-[450px]",children:(0,v.jsx)(b,{camera:W,mic:T,muted:!0,active:!0,srcObject:R,header:(0,v.jsx)(P,{localMediaStream:R}),body:(0,v.jsx)(S,{streamError:H}),footer:(0,v.jsx)(D,{camera:W,toggleCamera:function(){z((function(e){G(e?"":"Camera is turned off")}))},mic:T,toggleAudio:L})})})]})})})]})}},2361:function(){},4616:function(){}}]);
//# sourceMappingURL=549.4c768632.chunk.js.map